# Мастерская № 1 "Startups operations/close predictions"
### Описание проекта 
***Вам предстоит работать с табличными данными, в которых представлена информация о стартапах, которые функционировали в период с 1980 по 2018 годы. Вам нужно предсказать, какие из них закроются, а какие нет.***

### Цель проекта 
1. Разработать модель машинного обучения для предсказания продолжения деятельности стартапа. 
2. Провести полноценный разведочный анализ и сформировать рекомендации будущим создателям стартапов (какие факторы влияют на успешность стартапа).


### Исходные данные 
***Датасет состоит из двух файлов (+пример с выгрузкой): тренировочный набор (около 53к записей) и тестовый набор (около 13к записей). Тренировочный набор содержит целевой признак status, указывающий на то, закрылся стартап или продолжает действовать. Временной период - '1970-01-01' по '2018-01-01'. Дата формирования выгрузки - '2018-01-01'***
- kaggle_startups_train.csv - информация (53 000) стартапах, которые будут использоваться в качестве обучающих данных.
- kaggle_startups_test.csv - информация (13 000) стартапах, которые будут использоваться в качестве тестовых данных. Ваша задача - предсказать значение 'status' для каждого стартапа из этого датасета.\
    name - Название стартапа\
    category_list - Список категорий, к которым относится стартап\
    funding_total_usd - Общая сумма финансирования в USD\
    status - Статус стартапа (закрыт или действующий)\
    country_code - Код страны\
    state_code - Код штата\
    region - Регион\
    city - Город\
    funding_rounds - Количество раундов финансирования\
    founded_at - Дата основания\
    first_funding_at - Дата первого раунда финансирования\
    last_funding_at - Дата последнего раунда финансирования\
    closed_at - Дата закрытия стартапа (если применимо)\
    lifetime - Время существования стартапа в днях
- kaggle_startups_sample_submit.csv - файл с примером предсказаний в правильном формате.
    name - идентификатор (название) стартапа в тестовом наборе.\
    status - целевой признак. Для каждого стартапа предскажите категориальное значение соответствующее прогнозу ['operating', 'closed'].

### В ходе выполнения проектной работы выполнены:
- предобработка данных;
- исследовательский анализ данных;
- синтез новых признаков;
- проверка на мультиколлинеарность;
- обучение модели и оценка её качества;
- SHAP анализ.

# 1 Предобработка данных
***В ходе предобработки данных был выявлен дисбаланс классов в целевом признаке, ни смотря на это было принято решение удалить все пропуски из тренировочной выборки. Данное решение не устранило дисбаланс классов, но тем не менее избавились от нежелательных пропусков. В столбце category_list было написано несколько категорий из за чего было решено оставить только первую категорию. В дальнейшем пропуски в 'funding_total_usd' были заполнены медианным значением 'funding_total_usd' по категориям. такие же действия, кроме удаления строк с пропусками, были проведены и для тестовой выборки.***

# 2 Исследовательский анализ данных
***В ходе исследовательского анализа данных выяснено, что график распределения 'funding_total_usd' похож на распределение Пуассона, но из за наличия выбросов в данных он был очень узкий. На основании этого было принято решение удалить значения меньше 5% квантиля и больше 95% квантиля. После чего были построены боксплоты распределения общего сбора денег для открытых и закрытых страпов для топ 10 категорий и топ 10 стран. Также в данном разделе проверено распределение общего сбора денег для открытых и закрытых стартапов.***

# 3 Синтез новых признаков
***Так как даты не совсем удачный признак для обучения, было принятно решение, что столбец 'first_funding_at' разбить на 2 новых столбца 'first_funding_at_year' и 'first_funding_at_month' с годом и месяцем первого фандинга соответсвенно. Добавлен новый признак 'liftime', который получился в следствии вычетания даты формирования датасета или даты основания стартапа в столбце 'founding_at' из даты закрытия стартапа в столбце 'closed_at'. Также из за широкого дипазона значений 'liftime' добавлен новы столбец 'log_liftime'.***

# 4 Проверка на мультиколлинеарность 
***В ходе проверки на мультиколлинеарность выявлены столбцы которые не войдут в обучающую выборку, а именно столбцы: 'founded_at', 'first_funding_at', 'last_funding_at', 'closed_at', 'state_code', 'region', 'сity'. Так как некоторых столбцов нет в тестовой выборке, а их синтез из имеющихся данных невозможен. Остальные столбцы 'first_funding_at' и 'last_funding_at' взаимосвязаны между собой, а столбцы 'state_code', 'region', 'сity' взаимосвязаны с 'country_code'.***

# 5 Обучение модели и оценка её качества
***Для обучения была выбрана модель CatBoost, поиск параметров осуществяляся с помощью GridSearchCV. Оценка качества модели осуществлялась с помощью f1_score. На платформе Kaggle тестовая выборка дала результат 0.86678.***

# 6 SHAP анализ
***В ходе SHAP анализа выявлено, что наиболее значимыми признакми являются год первого фандинга и продолжительность жизни проекта. Это обосновано тем, что чем дольше живет проект тем вероятность того, что он закроется сокращается (это очевидно), а вот год первого фандинга я предполагаю, что в разные периоды времени у нас в мире была разная экономическая обстановка, и некоторые стартапы открывались на расцвете мировой экономики, а некоторые на спадах.***

# Предсказания модели на тестовой выборке находятся в файле submission.csv